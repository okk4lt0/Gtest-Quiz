"""
syllabus.py
===========

G検定シラバス（2024 v1.3）の章構造を厳密に定義し、
アプリ全体が参照できる形で提供する。

出題の偏りを抑えるための “章一覧” の正規データソースであり、
meta.json や question_bank.jsonl と完全に整合する。

章階層:
- domain（技術分野 / 法律・倫理分野）
- chapter_group（中分類）
- chapter_id（番号付き章名）
"""

from dataclasses import dataclass
from typing import List, Dict


# ============================================================
# データ構造
# ============================================================

@dataclass(frozen=True)
class Chapter:
    """シラバスの1つの項目を表すデータ構造"""
    domain: str
    chapter_group: str
    chapter_id: str


# ============================================================
# シラバス構造（2024 v1.3）
# ============================================================
# これは PDF の公式構造を忠実にコード化したもの。
# すべての chapter_id は question_bank.jsonl と完全に一致する。
# ============================================================

SYLLABUS_STRUCTURE: List[Chapter] = [
    # --------------------------------------------------------
    # 技術分野
    # --------------------------------------------------------
    Chapter("技術分野", "人工知能とは", "1. 人工知能の定義"),
    Chapter("技術分野", "人工知能とは", "2. 人工知能分野で議論される問題"),

    Chapter("技術分野", "人工知能の歴史", "3. 人工知能の歴史"),

    Chapter("技術分野", "探索と推論", "4. 探索"),
    Chapter("技術分野", "探索と推論", "5. 推論"),

    Chapter("技術分野", "機械学習", "6. 機械学習の基礎"),
    Chapter("技術分野", "機械学習", "7. 回帰分析"),
    Chapter("技術分野", "機械学習", "8. 分類"),
    Chapter("技術分野", "機械学習", "9. クラスタリング"),
    Chapter("技術分野", "機械学習", "10. 次元削減"),

    Chapter("技術分野", "ディープラーニングの基礎", "11. ニューラルネットワークの基礎"),
    Chapter("技術分野", "ディープラーニングの基礎", "12. 活性化関数"),
    Chapter("技術分野", "ディープラーニングの基礎", "13. 最適化手法"),
    Chapter("技術分野", "ディープラーニングの基礎", "14. 正則化"),
    Chapter("技術分野", "ディープラーニングの基礎", "15. CNN"),
    Chapter("技術分野", "ディープラーニングの基礎", "16. RNN"),
    Chapter("技術分野", "ディープラーニングの基礎", "17. LSTM"),
    Chapter("技術分野", "ディープラーニングの基礎", "18. Transformer"),

    Chapter("技術分野", "ディープラーニングの応用技術", "19. Batch Normalization"),
    Chapter("技術分野", "ディープラーニングの応用技術", "20. プーリング層"),
    Chapter("技術分野", "ディープラーニングの応用技術", "21. スキップ結合"),
    Chapter("技術分野", "ディープラーニングの応用技術", "22. 回帰結合層"),
    Chapter("技術分野", "ディープラーニングの応用技術", "23. Attention"),
    Chapter("技術分野", "ディープラーニングの応用技術", "24. オートエンコーダ"),
    Chapter("技術分野", "ディープラーニングの応用技術", "25. データ拡張"),

    Chapter("技術分野", "ディープラーニングの応用例", "26. 画像認識"),
    Chapter("技術分野", "ディープラーニングの応用例", "27. 自然言語処理"),
    Chapter("技術分野", "ディープラーニングの応用例", "28. 音声処理"),
    Chapter("技術分野", "ディープラーニングの応用例", "29. 深層強化学習"),
    Chapter("技術分野", "ディープラーニングの応用例", "30. データ生成"),
    Chapter("技術分野", "ディープラーニングの応用例", "31. 転移学習・ファインチューニング"),
    Chapter("技術分野", "ディープラーニングの応用例", "32. マルチモーダル"),
    Chapter("技術分野", "ディープラーニングの応用例", "33. モデルの解釈性"),
    Chapter("技術分野", "ディープラーニングの応用例", "34. モデルの軽量化"),

    Chapter("技術分野", "AIの社会実装に向けて", "35. AIプロジェクトの進め方"),
    Chapter("技術分野", "AIの社会実装に向けて", "36. データの収集・加工・分析・学習"),

    Chapter("技術分野", "AIに必要な数理・統計知識", "37. AIに必要な数理・統計知識"),

    # --------------------------------------------------------
    # 法律・倫理分野
    # --------------------------------------------------------
    Chapter("法律・倫理分野", "AIに関する法律と契約", "1. 個人情報保護法"),
    Chapter("法律・倫理分野", "AIに関する法律と契約", "2. 著作権法"),
    Chapter("法律・倫理分野", "AIに関する法律と契約", "3. 特許法"),
    Chapter("法律・倫理分野", "AIに関する法律と契約", "4. 不正競争防止法"),
    Chapter("法律・倫理分野", "AIに関する法律と契約", "5. 独占禁止法"),
    Chapter("法律・倫理分野", "AIに関する法律と契約", "6. AI開発委託契約"),
    Chapter("法律・倫理分野", "AIに関する法律と契約", "7. AIサービス提供契約"),

    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "8. 国内外のガイドライン"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "9. プライバシー"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "10. 公平性"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "11. 安全性とセキュリティ"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "12. 悪用"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "13. 透明性"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "14. 民主主義"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "15. 環境保護"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "16. 労働政策"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "17. その他の重要な価値"),
    Chapter("法律・倫理分野", "AI倫理・AIガバナンス", "18. AIガバナンス"),
]


# ============================================================
# ユーティリティ関数
# ============================================================

def load_syllabus_structure() -> List[Dict]:
    """
    app.py や meta, question_bank で利用しやすいように
    dict のリストとして返す。

    例:
    {
        "domain": "技術分野",
        "chapter_group": "人工知能とは",
        "chapter_id": "1. 人工知能の定義"
    }
    """
    return [
        {
            "domain": c.domain,
            "chapter_group": c.chapter_group,
            "chapter_id": c.chapter_id,
        }
        for c in SYLLABUS_STRUCTURE
    ]


def get_all_chapter_ids() -> List[str]:
    """全 chapter_id をリストで返す"""
    return [c.chapter_id for c in SYLLABUS_STRUCTURE]
